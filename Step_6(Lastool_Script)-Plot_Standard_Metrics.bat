REM THIS SCRIPT GENERATES STATISTICAL BASED STANDARD METRICS FROM PLOT BASED HEIGHT NORMALIZED LIDAR FILES

@echo off

set Lastools_Directory=C:\LAStools\bin\
set Input_Files_Directory="Input File Path" REM INPUT LIDAR FILES IN .LAZ FORMAT
set Input_Plot_File="Input Polygon Shapefile Name" REM INPUT BOUNDARY FILE IN .SHP FORMAT
set Output_File_Directory="Output File Path"
set Output_File=Output File Name REM OUTPUT FILE NAME IN .CSV FORMAT

%Lastools_Directory%lascanopy -i %Input_Files_Directory%\*.laz ^
-merged ^ REM METRICS FOR EACH PLOT FILE ARE MERGED 
-lop %Input_Plot_File% ^
plotid ^ REM IDS OF PLANTATION PLOTS
-centroids ^ REM PLOT CENTROIDS
-cov ^ REM CANOPY COVER
-dns ^ REM CANOPY DENSITY
-cover_cutoff 2 ^ REM CANOPY COVER CUTOFF
-height_cutoff 2 ^ REM HEIGHT CUTOFF (HEIGHT CUTOFF IS SIMILAR TO CANOPY COVER CUTOFF FOR FORESTRY APPLICATIONS)
-all ^ REM TOTAL NUMBER OF POINTS
-abv ^ REM NUMBER OF POINTS ABOVE THE CUTOFF
-min ^ REM MINIMUM POINT HEIGHT ABOVE THE CUTOFF
-max ^ REM MAXIMUM POINT HEIGHT ABOVE THE CUTOFF
-avg ^ REM AVERAGE POINT HEIGHT ABOVE THE CUTOFF
-std ^ REM STANDARD DEVIATION OF POINTS HEIGHT ABOVE THE CUTOFF
-ske ^ REM SKEWNESS OF POINTS HEIGHT ABOVE THE CUTOFF
-kur ^ REM KURTOSIS OF POINTS HEIGHT ABOVE THE CUTOFF
-qav ^ REM QUADRATIC AVERAGE OF POINTS HEIGHT ABOVE THE CUTOFF
-hom ^ REM MEDIAN OF POINTS HEIGHT ABOVE THE CUTOFF
-p 1 5 10 25 50 75 90 95 99 ^ REM PERCENTILES (1%,5%,10%,25%,75%,90%,95%,99%) OF POINTS HEIGHT ABOVE THE CUTOFF
-b 10 20 30 40 50 60 70 80 90 ^ REM BICENTILES (10%,20%,30%,40%,50%,60%,70%,80%,90%) OF POINTS HEIGHT ABOVE THE CUTOFF
-c 10 20 30 40 50 ^ REM NUMBER OF POINTS WITH HEIGHT IN BETWEEN 0-10,10-20,20-30,30-40,40-50m
-d 10 20 30 40 50 ^ REM DENSITY OF POINTS WITH HEIGHT IN BETWEEN 0-10,10-20,20-30,30-40,40-50m
-int_min ^ REM MINIMUM POINT INTENSITY ABOVE THE CUTOFF
-int_max ^ REM MAXIMUM POINT INTENSITY ABOVE THE CUTOFF
-int_avg ^ REM AVERAGE POINT INTENSITY ABOVE THE CUTOFF
-int_std ^ REM STANDARD DEVIATION OF POINT INTENSITY ABOVE THE CUTOFF
-int_ske ^ REM SKEWNESS OF POINTS INTENSITY ABOVE THE CUTOFF
-int_kur ^ REM KURTOSIS OF POINTS INTENSITY ABOVE THE CUTOFF
-int_qav ^ REM QUADRATIC AVERAGE OF POINTS INTENSITY ABOVE THE CUTOFF
-int_p 1 5 10 25 50 75 90 95 99 ^ REM PERCENTILES (1%,5%,10%,25%,75%,90%,95%,99%) OF POINTS INTENSITY ABOVE THE CUTOFF
-int_c 10 20 30 40 50 ^ REM NUMBER OF POINTS WITH INTENSITY IN BETWEEN 0-10,10-20,20-30,30-40,40-50m HEIGHTS
-int_d 10 20 30 40 50 ^ REM DENSITY OF POINTS WITH INTENSITY IN BETWEEN 0-10,10-20,20-30,30-40,40-50m HEIGHTS
-ocsv ^
-odir %Output_File_Directory% ^
-o %Output_File%
pause